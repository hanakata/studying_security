第6章 キャリッジリターンライフフィードインジェクション

・HTTPリクエストスマグリング
HTTPリクエストスマグリングは攻撃者がCRLFインジェクション脆弱性を悪用して、
最初の正当なリクエストに2番目のHTTPリクエストを追加するもの。
アプリケーションは挿入されたCRLFを予想していないので最初は2つのリクエストを単一のリクエストとして扱う。
この種の脆弱性はキャッシュポイズニング、ファイアウォール回避、リクエストハイジャック、HTTPレスポンス分割につながる

・v.shopify.comのレスポンス分割
last_shopパラメータの一部としてURLに改行コードを含めることができた。
そのため、レスポンスを分割し様々な脆弱性の可能性が生じる。
　教訓
　サイトが入力を受け付けそれをリターンヘッダーの一部として用いるような場合、特にそれがcookieを設定しているような場合、
　目を光らせる必要がある。
　サイトでこの振る舞いを見た場合、%0D%0Aをサブミットしてサイトがインジェクションに対して保護されているかを確認する
　確認し保護されていなければ新しいヘッダーを追加できないかテストをしてみる
・TwitterのHTTPレスポンス分割
脆弱性を探すときはサイトがどのように入力を扱うかをみるためにエンコードした値をサブミットする
　教訓
　何らかの形でサーバが%0D%0AというキャラクタをサニタイズしているならWebサイトがどのようにそれを行っているのか
　その作業をダブルエンコーディングを通じてといった方法で回避できないかを考える
