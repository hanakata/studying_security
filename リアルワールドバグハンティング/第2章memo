第2章 オープンリダイレクト
・オープンリダイレクトとは
→Webサイトがブラウザに対して異なるURLを送信したときに生じるものでこのURLは別のドメインの可能性がある。
　→与えられたドメインに対する信頼を悪用してターゲットを悪意あるWebサイトへ誘導する。
　　フィッシング攻撃も可能。
オープンリダイレクトはユーザをリダイレクトするだけなのでインパクトが小さくバウンティ（報奨金制度）に相当しないと考えられることがある。
例えばGoogleなど。OWASPに関してもランキングから除外している。

・オープンリダイレクトの動作
オープンリダイレクトは開発者が攻撃者によって制御された入力を誤って信頼してしまい、
ほかのサイトへリダイレクトしてしまった場合に起こる。
これはURLパラメータ、HTMLの<meta>リフレッシュタグ、DOMのwindow locationパラメータが使われる。
リダイレクトするサイトの情報がGETパラメータで送られている場合、
それを書き換えられたらリダイレクト先を操作されてしまう。
JavaScript を使ってDOMを通じてウィンドウのlocationプロパティを変更してユーザをリダイレクトできる。

・事例
https://hackerone.com/reports/101962
https://hackerone.com/reports/103772
https://hackerone.com/reports/111968

・まとめ
オープンリダイレクトを見つけるためには観察が必要
→例えばリダイレクトのパラメータが明確になっているなど。
悪用の方法としては例えばメールで
https://<ログインページ>?redirect=<フィッシングサイト>
とかやればデータを取得できる。